P_STRAIGHT_LOOP(16, {
  pd = (ps1 + ps2) >> 1;
}, {
  pd = (ps1 - ps2) >> 1;
})